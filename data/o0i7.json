{"name":"o0i7","title":"forked: 安全なつもりのeval：alertしてみてください","description":"","libraries":["/lib/jquery-1.6.2"],"js":{"language":"js","content":"// forked from yuitest's \"安全なつもりのeval：alertしてみてください\" http://jsdo.it/yuitest/dxSe\nfunction SecureEval(str) {\n  var str2 = '';\n  var allow = ['JSON','Number','String','Math','Date'];\n  for (var name in window) {\n    if (allow.indexOf(name) === -1) {\n      str2 += 'var ' + name + ' = void 0;';\n    }\n  }\n  str2 += 'var Function = void 0;'\n  return evalInner.apply({}, [str2, str])\n  function evalInner () {\n    eval(arguments[0]);\n    try {\n　　　　return eval(arguments[1]);\n    } catch (e) {\n      return e;\n    }  \t\n  }\n}\n$(function () {\n  $('#letsEval').click(function (e) {\n    $('#returnText').val(SecureEval($('#evalText').val()).toString());\n  });\n});"},"html":{"language":"html","content":"<strong>安全なeval<br />攻撃(DOM, alert)できるもんなら<br />してみやがれ！！！<br />(正解はあります)</strong>\n<textarea id=\"evalText\">0..constructor.constructor('return this')().alert(0)</textarea><br />\n<input type=\"button\" value=\"安全なEval\" id=\"letsEval\" /><br />\n結果：<br />\n<textarea id=\"returnText\"></textarea>"},"css":{"language":"css","content":"body { background-color: #DDDDDD; font: 30px sans-serif; }\ntextarea {\n  width : 100%;\n  height : 100px;\n}"},"published":"2011-09-20T00:52:13"}