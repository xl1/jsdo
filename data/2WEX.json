{"name":"2WEX","title":"forked: three.js　軸回転のテスト","description":"","libraries":["/lib/three.js-r47"],"js":{"language":"js","content":"// forked from motomizuki's \"three.js　軸回転のテスト\" http://jsdo.it/motomizuki/vI5z\nvar camera, scene, renderer,\n    geometry, meterial, mesh,\n\n    shiftF = false,\n    rotateState = new THREE.Vector3(),\n    KEY = {\n      RIGHT: 39,\n      UP: 38,\n      LEFT: 37,\n      DOWN: 40,\n      SHIFT: 16\n    };\n\ninit();\n\nfunction init(){\n  scene = new THREE.Scene();\n\n  camera = new THREE.PerspectiveCamera(75, 1, 1, 10000);\n  camera.position.z = 1000;\n  scene.add(camera);\n\n  geometry = new THREE.CubeGeometry(200, 200, 200);\n  material = new THREE.MeshBasicMaterial({ color: 0xff0000, wireframe: true });\n\n  mesh = new THREE.Mesh(geometry, material);\n  // クオータニオンを使うようにする\n  // mesh.rotation は無視されるようになる\n  mesh.useQuaternion = true;\n\n  scene.add(mesh);\n\n  renderer = new THREE.CanvasRenderer();\n  renderer.setSize(465, 465);\n\n  document.body.appendChild(renderer.domElement);\n\n  document.addEventListener('mousedown', clickHandler, false);\n  document.addEventListener('keydown', keydownHandler, false);\n  document.addEventListener('keyup', keyupHandler, false);\n\n  render();\n}\n\n// 描画する\nfunction render(){\n  document.getElementById('rotation').innerHTML = [\n    'x: ' + rotateState.x,\n    'y: ' + rotateState.y,\n    'z: ' + rotateState.z\n  ].join('<br />');\n\n  renderer.render(scene, camera);\n}\n\n// mesh を回転させる\nfunction rotate(x, y, z){\n  var vec = new THREE.Vector3(x, y, z),\n      quat = new THREE.Quaternion().setFromEuler(vec);\n  mesh.quaternion.multiplySelf(quat);\n\n  rotateState.addSelf(vec);\n  render();\n}\n\nfunction clickHandler(e){\n  rotate(0, 0, shiftF ? 3 : -3);\n}\n\nfunction keydownHandler(e){\n  switch(e.keyCode){\n    case KEY.RIGHT: rotate(3, 0, 0); break;\n    case KEY.UP:    rotate(0, 3, 0); break;\n    case KEY.LEFT:  rotate(-3, 0, 0); break;\n    case KEY.DOWN:  rotate(0, -3, 0); break;\n    case KEY.SHIFT: shiftF = true; break;\n    default: break;\n  }\n}\n\nfunction keyupHandler(e){\n  if(e.keyCode === KEY.SHIFT){\n    shiftF = false;\n  }\n}\n"},"html":{"language":"html","content":"<div id=\"rotation\"></div>"},"css":{"language":"css","content":"body { background-color: #DDDDDD; font: 30px sans-serif; }\ncanvas { position: absolute; top: 0; left: 0; }"},"published":"2012-02-25T10:41:59"}