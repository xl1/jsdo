{"name":"9byk","title":"forked: Voronoi diagram","description":"about:flags &#x3067; Enable Media Stream &#x3057;&#x305F; Chrome dev &#x3067;<br>\n&#xFF08;&#x307E;&#x305F;&#x306F;&#x8D77;&#x52D5;&#x30AA;&#x30D7;&#x30B7;&#x30E7;&#x30F3;  --enable-media-stream&#xFF09;<br>\n<br>\nwebcam &#x306E;&#x6620;&#x50CF;&#x64AE;&#x3063;&#x3066;&#x52A0;&#x5DE5;<br>\n<br>\n1/30<br>\nwebcam &#x304C;&#x4F7F;&#x3048;&#x306A;&#x3044;&#x5834;&#x5408;&#x306F; <a href=\"./assets/trailer.webm\">./assets/trailer.webm</a> &#x306E;&#x6620;&#x50CF;&#x3092;&#x4F7F;&#x3046;&#x3053;&#x3068;&#x306B;&#x3057;&#x305F;&#xFF08;&#x97F3;&#x91CF;&#x6CE8;&#x610F;&#xFF09;","libraries":["/xl1/eHqL"],"js":{"language":"js","content":"(function(){\n\nvar PI2 = Math.PI * 2,\n    NUM_POINTS = 400;\n\nvar gl = new MicroGL();\nif(!gl.enabled) return alert('sorry webgl not supported');\ngl.program($('vshader').textContent, $('fshader').textContent);\n\nvar video = document.createElement('video'),\n    tex,\n    points = randArray(NUM_POINTS * 2),\n    velocity = randArray(NUM_POINTS * 2),\n    userMedia = navigator.getUserMedia || navigator.webkitGetUserMedia,\n    setCamera = function(src){\n      var url = window.URL || window.webkitURL;\n      video.src = url ? url.createObjectURL(src) : src;\n    },\n    setVideo = function(){\n      video.src = '../assets/trailer.webm';\n      video.loop = true;\n    };\n    \nif(userMedia){\n  try{\n    userMedia.call(navigator, { video: true }, setCamera, setVideo);\n  } catch(e) {\n    userMedia.call(navigator, 'video', setCamera, setVideo);\n  }\n} else setVideo();\n\ngl.bindVars({ aPosition: createCone() });\nvideo.addEventListener('canplay', init, false);\n\nfunction init(){\n  gl.init(document.body, 465, 465);\n  video.play();\n  requestAnimationFrame(update);\n}\n\nfunction update(){\n  var i = NUM_POINTS,\n      px, py;\n\n  gl.clear();\n\n  gl.bindVars({\n    uSampler: tex = gl.texture(video, tex)\n  });\n\n  for(; i--;){\n    px = points[i * 2]     += (velocity[i * 2] - 0.5) / 100;\n    py = points[i * 2 + 1] += (velocity[i * 2 + 1] - 0.5) / 100;\n    gl.bindVars({\n      uPoint: [px, py]\n    });\n    gl.draw('TRIANGLE_FAN');\n  }\n  requestAnimationFrame(update);\n}\n\nfunction createCone(level){\n  var i = level = level || 90,\n      res = [0, 0, -1, 1, 0, 0],\n      rad;\n  for(; i--;){\n    rad = i * PI2 / level;\n    res.push(Math.cos(rad));\n    res.push(Math.sin(rad));\n    res.push(0);\n  }\n  return res;\n}\n\nfunction randArray(num){\n  var i = num,\n      res = [];\n  for(; i--;){\n    res[i] = Math.random();\n  }\n  return res;\n}\n\nfunction $(i){\n  return document.getElementById(i);\n}\n\n})();"},"html":{"language":"html","content":"<script type=\"text/x-vertex-shader\" id=\"vshader\">\nuniform   vec2 uPoint;\nuniform   sampler2D uSampler;\nattribute vec3 aPosition;\nvarying   vec4 vColor;\n\nvoid main(){\n  gl_Position = vec4(\n    aPosition.xy * 3.0 + mod(uPoint, 1.0) * 2.0 - 1.0,\n    aPosition.z,\n    1.0\n  );\n  vColor = texture2D(uSampler, mod(uPoint, 1.0));\n}\n</script>\n<script type=\"text/x-fragment-shader\" id=\"fshader\">\nprecision mediump float;\n\nvarying vec4 vColor;\n\nvoid main(){\n  gl_FragColor = vColor;\n}\n</script>"},"css":{"language":"css","content":"body { margin: 0; overflow: hidden; }"},"published":"2012-05-25T22:47:13"}