{"name":"dS6S","title":"PeerJS test","description":"<div class=\"markdown\"><p><a href=\"http://peerjs.com\">PeerJS</a> &#x4FBF;&#x5229;</p>\n\n<p>&#x4ECA;&#x306E;&#x3068;&#x3053;&#x308D; Chrome 26+ &#x3067;&#x4F7F;&#x3048;&#x308B;&#xFF08;Android &#x7248;&#x3082;&#xFF09;</p>\n</div>","libraries":[],"js":{"language":"coffeescript","content":"uuid = do ->\n    re = /[xy]/g\n    replacer = (c) ->\n        r = Math.random() * 16 |0\n        (if c is 'x' then r else (r & 3 | 8)).toString 16\n    ->\n        'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(re, replacer).toUpperCase()\n        \n$ = (id) -> document.getElementById id\n\nlog = (txt) -> $('log').insertAdjacentHTML 'beforeend', \"<li>#{txt}</li>\"\n\ngetId = ->\n    /\\Wid=([-0-9A-F]{36})/.exec(location.search)?[1]\n\nconnect = (conn) ->\n    log \"connected to: #{conn.peer}\"\n    conn.on 'data', (data) -> log \"received: #{unescape data}\"\n    \n    btn = $('btn')\n    btn.disabled = false\n    btn.addEventListener 'click', ->\n        str = new Date().toString()\n        conn.send escape str\n        log \"send: #{str}\"\n    , false\n    \nmain = ->\n    id = uuid()\n    peer = new Peer id, key: 'v9z16y8nolzvvx6r'\n    \n    if oid = getId()\n        conn = peer.connect oid\n        conn.on 'open', -> connect conn\n    else\n        img = document.createElement 'image'\n        img.src = 'http://chart.apis.google.com/chart?chs=300x300&cht=qr&chl=' +\n            location.href + '?id=' + id\n        document.body.appendChild img\n        peer.on 'connection', (conn) ->\n            connect conn\n            document.body.removeChild img\n            \nmain()"},"html":{"language":"html","content":"<script src=\"http://cdn.peerjs.com/0/peer.min.js\"></script>\n<button id=\"btn\" disabled>push</button>\n<div id=\"log\"></div>"},"css":{"language":"css","content":"button { width: 300px; height: 40px; }"},"published":"2013-03-22T11:07:34"}