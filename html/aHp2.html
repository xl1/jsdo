<!DOCTYPE HTML>
<html lang="ja" xmlns:og="http://ogp.me/ns#" xmlns:mixi="http://mixi-platform.com/ns#" xmlns:fb="http://www.facebook.com/2008/fbml"  class="osOther" xmlns:wb="http://open.weibo.com/wb">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE9" />

<title>dithering algorithms - jsdo.it - Share JavaScript, HTML5 and CSS</title>

<meta property="qc:admins" content="21506643427614" />
<meta property="wb:webmaster" content="5c8153403c54c98f" />
<meta name="description" content="dithering algorithms by xl1 @ jsdo.it - share JavaScript, HTML5 and CSS - jsdo.it is a service to write JavaScript, HTML5, CSS in your browser and share it. You can copy and modify others' code. And also Ask questions about JavaScript, HTML5, CSS" />

<meta name="keywords"  content="judo.it,JavaScript,HTML5,CSS,jsdoit" />

<meta name="author" content="jsdoit Inc." />
<meta name="license" content="&#169;jsdoit Inc." />

<meta property="og:site_name" content="jsdo.it" />
<meta property="fb:page_id" content="138382942860000" />
<meta property="fb:app_id" content="104748116268345" />
<meta property="og:locale" content="ja_JP">

<meta property="og:type" content="article" />

<meta property="og:url" content="http://jsdo.it/xl1/aHp2" />

<meta property="og:description" content="dithering algorithms by xl1 @ jsdo.it - ref: [Arbitrary-palette positional dithering algorithm](http://bisqwit.iki.fi/story/howto/dither/jy/)" />
<meta property="twitter:description" content="dithering algorithms by xl1 @ jsdo.it - ref: [Arbitrary-palette positional dithering algorithm](http://bisqwit.iki.fi/story/howto/dither/jy/)" />




<meta property="og:image" content="http://jsdo-static-contents.s3.amazonaws.com/images/capture/a/H/p/aHp2.jpg?t=1364141461" />
<meta property="og:image:width" content="465" />
<meta property="og:image:height" content="465" />

<meta name="twitter:site" content="@jsdo_it">
<meta name="twitter:card" content="summary">




<meta property="og:title" content="dithering algorithms" />
<meta name="twitter:title" content="dithering algorithms" />


<link rel="shortcut icon" type="image/vnd.microsoft.icon" href="/img/favicon.ico" />
<link rel="start" href="/" title="home" />
<link rel="stylesheet" type="text/css" media="screen,print" href="/css/common.css?1468627570" />

<link rel="stylesheet" type="text/css" media="screen,print" href="/css/code.css?1468627570" />
<link rel="stylesheet" type="text/css" media="screen,print" href="/css/codemirror/codemirror.css?1441025678" />
<link rel="stylesheet" type="text/css" media="screen,print" href="/css/codemirror/themes.css?1441025678" />
<link rel="stylesheet" type="text/css" media="screen,print" href="/css/SyntaxHighlighter.css?1441025678" />

<script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
</head>

<!--[if IE 9]><body class="ie9 i_default"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--><body class="i_default"><!--<![endif]-->

<script type="text/javascript">
var language = "i_default"; // used in l()
</script>

<!-- script 'type="text/javascript" src="https://www.google.com/jsapi"></script -->

<!--[if IE]>
<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
<!-- adtype =  -->
<!-- Google DoubleClick 広告のスクリプトページ -->
<div id="container" class="codepage contents">
<!--[[[ HEADER-AREA ]]]-->
<!-- country = JP -->
<header id="headerGlobal" class="group">
<div class="sub">
<div class="layoutContainer layoutLiquid group">

<!-- PR欄&リンク -->
<style>
#headerGlobal .pr a:before {
    content: "重要なお知らせ";
}
#headerGlobal .pr a {
    color: red;
    font-size: 14px;
    text-shadow: none;
    padding-right: 11px;
}
</style>
<p class="pr" style="color:red; font-"><a href="http://jsdo.it/blog/2019/07/jsdoit-1.html">
【重要】サービス終了のお知らせ</a></p>
<!-- PR欄&リンク -->


<ul id="headerLanguage">
<li class="column">
<span class="header_menu_column" id="header_menu_column_1"><a href="#"><span class="thumb"></span>English</a></span>
<div class="navGlobalSub">
<ul class="shadowLayor1">
<li><a href="?lang=en" class="usa">English</a></li>
<li style="display:none;"><a href="#" class="kor">한국어</a></li>
<li><a href="?lang=zh-CN" class="chn">中文</a></li>
<li><a href="?lang=ja" class="jpn">日本語</a></li>
</ul>
</div>
</li>
<!-- / #headerAccount --></ul>
<ul id="navGlobal">
<li><a href="/tags" title="Tags">Tags</a></li>
<li><a href="/about" title="About">About</a></li>
<li><a href="/event/topics" title="Topics &amp; Events">Topics &amp; Events</a></li>
<li><a href="/qa" title="Discussions">Discussions</a></li>
<li><a href="http://games.jsdo.it" title="jsdo.it HTML5-Games">HTML5-Games</a></li>
<!-- / #navGlobal --></ul>
<!-- / .layoutContainer --></div>
<!-- / .sub --></div>
<div class="main">
<div class="layoutContainer layoutLiquid group">

<h1 id="siteName"><a href="/"><img src="/img/common/sitename_03.png" width="79" height="39" alt="jsdo.it - Share JavaScript, HTML5 and CSS" /></a></h1>

<div id="btnHeaderCodeNew">
<form method="post" action="/code/new">
<fieldset>
<p><input type="submit" value="Start coding"></p>
</fieldset>
<input type="hidden" name="token" value="">
</form>
<!-- / #btnHeaderCodeNew --></div>

<div id="navGlobalSearch">
<form method="get" action="/search" class="search">
<input id="inputSearch" type="text" name="q" class="query input-prompt" autocomplete="off" placeholder="Search"><input type="submit" value="" class="button">
</form>
<!--/#navGlobalSearch--></div>




<div id="headerSignin">
<p><a href="/login" onclick="this.href='/login?redirect=' + encodeURIComponent(location.pathname);" class="signup">Create account</a></p>
<p>or</p>
<div class="signin">
<p><a href="/login" onclick="this.href='/login?redirect=' + encodeURIComponent(location.pathname);" class="signin">LOGIN</a></p>
<div class="panel">
<div class="shadowLayor1">
<div class="service">
<ul>
<li class="google"><a href="/login/google?login=1" onClick="_gaq.push(['_trackPageview', '/login/service/google']);">Login with Google</a></li>
<li class="facebook"><a href="/login/facebook" onClick="_gaq.push(['_trackPageview', '/login/service/facebook']);">Login with Facebook</a></li>
<li class="twitter"><a href="/login/twitter" onClick="_gaq.push(['_trackPageview', '/login/service/twitter']);">Login with Twitter</a></li>



<li class="other"><a href="/login" onclick="this.href='/login?redirect=' + encodeURIComponent(location.pathname);">Other login options</a></li>

</ul>
</div>
</div>
</div>
</div>
<!-- / #headerSignin --></div>



<!-- / .layoutContainer --></div>
<!-- / .main --></div>



<div id="navPrimaryTag">
<div class="layoutContainer layoutLiquid">
<nav class="group">
<div class="search">
<form method="get" action="/search">
<input type="text" placeholder="Search" name="q" results="10" class="text" /><input type="submit" value="Search" class="hidden">
</form>
</div>
<ul class="group">
<li class="application"><a href="/tag/application" >Application</a></li>
<li class="ui"><a href="/tag/user_interface" >User Interface</a></li>
<li class="html5"><a href="/tag/html5_elements&amp;api" >HTML5 Elements &amp; API</a></li>
<li class="css"><a href="/tag/css" >CSS</a></li>
<li class="art"><a href="/tag/art&amp;design" >Art &amp; Design</a></li>
<li class="game"><a href="/tag/game" ">Game</a></li>
<li class="library"><a href="/tag/library&amp;test" >Library &amp; Test</a></li>
<li class="smartphone"><a href="/tag/smartphones&amp;tablets" >Smartphones &amp; Tablets</a></li>
<li class="all"><a href="/codes">All</a></li>
</ul>
</nav>
<!-- / .layoutContainer --></div>
<!-- / #navPrimaryTag --></div>






<!-- / #headerGlobal --></header>
<!--[[[ /HEADER-AREA ]]]-->


<!--[[[ CONTENT-AREA ]]]-->
<div id="body">
<article id="codeDetail" class="layoutContainer">



<section class="code">
<header class="group">

<div class="main">
<h1><a href="http://jsdo.it/xl1/aHp2" rel="bookmark">dithering algorithms</a></h1>
<div class="author group" itemscope itemtype="http://data-vocabulary.org/Person">
<p class="image"><a href="http://jsdo.it/xl1" title="xl1"><img src="//jsdo-static-contents.s3.amazonaws.com/images/icon/8/6/d/6/86d60104ce558994d02cd5e2e1cc4fdcbaccf61e_100.jpg" width="30" height="30" alt="xl1" title="xl1" itemprop="photo" /></a></p>
<p class="name"><a href="http://jsdo.it/xl1" title="xl1" rel="author" itemprop="url"><span itemprop="name">xl1</span></a></p>
<div class="connection">
	<div class="follow"><span onclick="this.href='/login?redirect=' + encodeURIComponent(location.pathname);" class="btnBase btnType2 btnSmall btnFollow">Follow</span></div>
</div>
<time datetime="2013-03-25T01:10:58">2013-03-25 01:10:58</time>
<p class="license">License: 
  <a href="/help#help_license">MIT License</a>
</p>
</div>
<!-- / .main --></div>

<div class="counts">
<div>
<span id="fork_button" class="fork btnBase btnType5">
<dl>
<dt>Fork</dt><dd>0</dd>
</dl>
</span>
</div>
<div>
<a href="http://jsdo.it/login?redirect=http%3A%2F%2Fjsdo.it%2Fxl1%2FaHp2" class="favorite btnBase btnType6 btnSmall">
<span class="favoriteIcon"><img src="/img/common/ico/ico_fav_02_shadow.png" width="15px" height="12px" /></span><dl class="group">
<dt>Fav</dt><dd>2</dd>
</dl>
</a><div href="/" class="pv">
<dl class="group">
<dt>View</dt><dd>2324</dd>
</dl>
</div>
</div>
<!-- / .counts --></div>
</header>

<script type="text/javascript">
var user = {
  screen_name: "xl1"
};
</script>


<div class="fullscreen group">
<div class="inner">
<ul class="controller">
<li class="btnBase btnType6 btnSmall btnInvisible btnStart" id="btnPlay" onclick="JSDoIt.CodeShow.play(); return false;"><span>Play</span></li>
<li class="btnBase btnType6 btnSmall btnInvisible btnStop" id="btnStop" style="display: none;" onclick="JSDoIt.CodeShow.stop(); return false;"><span>Stop</span></li>
<li class="btnBase btnType6 btnSmall btnInvisible btnReload" id="btnReload" style="display: none;" onclick="JSDoIt.CodeShow.reload(); return false;"><span>Reload</span></li>
</ul>
<p><a href="http://jsdo.it/xl1/aHp2/fullscreen" class="btnBase btnType6 btnSmall btnInvisible btnFullscreen" title="Fullscreen preview"><span>Fullscreen</span></a></p>
<p><span title="Smart Phone Preview" class="btnBase btnType6 btnSmall btnInvisible btnSmartphone" data-size="width=320,height=480"><span>Smart Phone</span></span></p>
</div>
</div>

<fieldset>

<section class="viewer group">

<div class="group areaCodeViewer">
<div class="boxCode" id="boxShowCode"><header>
<ul class="group">
<li class="description active" data-target-tab="boxEditDescription"><span>Readme</span></li>
<li class="js" data-target-tab="boxEditJS">CoffeeScript <small>258 lines</small></li>
<li class="html" data-target-tab="boxEditHTML">HTML <small>5 lines</small></li>
<li class="css" data-target-tab="boxEditCSS">CSS <small>0 lines</small></li>
</ul>
</header>


<section id="boxEditDescription">
<ul class="tabCode group">
</ul>
<div class="code" id="boxCodeDescription">

<div class="editorBox"><div class="transparent"><img src="/img/spacer.gif" /></div><div class="markdown"><p>ref: <a href="http://bisqwit.iki.fi/story/howto/dither/jy/">Arbitrary-palette positional dithering algorithm</a></p>
</div></div>

<!-- / .code --></div>
<!-- / #boxEditHTML --></section>

<section id="boxEditJS">
<ul class="tabCode group">
    <li title="dithering algorithms" class="selected tabJS initialTab"><span id="primaryTabTitle">dithering algorithms</span></li>    <li title="[library] MicroGL" class="tabJS"><span>[library] MicroGL</span></li></ul>
<div class="code" id="boxCodeJS"> 
<div class="editorBox"><div class="transparent"><img src="/img/spacer.gif" /></div><textarea id="codeJS" data-lang="coffeescript">vshader = '''
  attribute vec2 a_position;
  varying vec2 v_texCoord;

  void main(){
    v_texCoord = a_position / 2.0 + vec2(0.5);
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
'''

fshaderBase = '''
  precision mediump float;
  uniform sampler2D u_source;
  uniform sampler2D u_colors;
  varying vec2 v_texCoord;

  const float GAMMA = 2.2;

  vec4 gamma(vec4 color){
    return pow(color, vec4(GAMMA));
  }
  vec4 ungamma(vec4 color){
    return pow(color, vec4(1.0 / GAMMA));
  }
  int ditherIdx(){
    float p = floor(mod(gl_FragCoord.x, 4.0));
    float q = floor(mod(p - gl_FragCoord.y, 4.0));
    return int(
      8.0 * mod(q, 2.0) +
      4.0 * mod(p, 2.0) +
      2.0 * floor(q / 2.0) +
      floor(p / 2.0)
    );
  }
'''

fshader =
  tone: fshaderBase + '''
    const int COMBINATIONS = 64;
    
    void getColors(in int idx, out vec4 c1, out vec4 c2){
      float x = (0.5 + float(idx)) / float(COMBINATIONS);
      c1 = gamma(texture2D(u_colors, vec2(x, 0.0)));
      c2 = gamma(texture2D(u_colors, vec2(x, 2.0)));
    }
    float ditherIndex(){
      return (0.5 + float(ditherIdx())) / 16.0;
    }
    float calculateBestRatio(vec4 srcColor, vec4 c1, vec4 c2){
      vec4 dif = c2 - c1;
      return floor(
        0.5 + dot(dif, srcColor - c1) / dot(dif, dif) * 16.0
      ) / 16.0;
    }
    vec4 dither(vec4 srcColor){
      vec4 c1, c2, canditate;
      float ratio;
      float d, minDist = 9.9;
      float index = ditherIndex();
      
      for(int i = 0; i &lt; COMBINATIONS; i++){
        getColors(i, c1, c2);
        ratio = calculateBestRatio(srcColor, c1, c2);
        d = distance(srcColor, mix(c1, c2, clamp(ratio, 0.0, 1.0)));
        if(minDist &gt; d){
          minDist = d;
          if(index &gt; ratio){
            canditate = c1;
          } else {
            canditate = c2;
          }
        }
      }
      return canditate;
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  nterm: fshaderBase + '''
    const int LOOPMAX = 16;
    const int COLORLEN = 16;

    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 dither(vec4 srcColor){
      vec4 sum = vec4(0.0);
      int total = 0, di = ditherIdx();
      
      float d, mind;
      vec4 color, next;
      int nextp;

      for(int i = 0; i &lt; LOOPMAX; i++){
        mind = 9.9;
        for(int j = 0; j &lt; COLORLEN; j++){
          color = getColor(j);
          for(int p = 1; p &lt; LOOPMAX; p++){
            d = distance(srcColor,
              mix(sum, color, float(p) / float(total + p))
            );
            if(mind &gt; d){
              mind = d;
              next = color;
              nextp = p;
            }
          }
        }
        sum = mix(sum, next, float(nextp) / float(total + nextp));
        total += nextp;
        if(total &gt; di) return next;
      }
      return vec4(0.0);
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  tknoll: fshaderBase + '''
    const int COLORLEN = 16;
    const float COEF = 0.2;
    
    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 nearest(vec4 srcColor){
      vec4 col, minCol;
      float d, mind = 9.9;
      
      for(int i = 0; i &lt; COLORLEN; i++){
        col = getColor(i);
        d = distance(srcColor, col);
        if(mind &gt; d){
          minCol = col;
          mind = d;
        }
      }
      return minCol;
    }
    vec4 dither(vec4 srcColor){
      int index = ditherIdx();
      vec4 nearCol, color = srcColor, err = vec4(0.0);
      for(int i = 0; i &lt; 16; i++){
        nearCol = nearest(srcColor + COEF * err);
        if(i == index) return nearCol;
        err += srcColor - nearCol;
      }
      return vec4(0.0);
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  nodither: fshaderBase + '''
    const int COLORLEN = 16;
    
    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 nearest(vec4 srcColor){
      vec4 col, minCol;
      float d, mind = 9.9;
      
      for(int i = 0; i &lt; COLORLEN; i++){
        col = getColor(i);
        d = distance(srcColor, col);
        if(mind &gt; d){
          minCol = col;
          mind = d;
        }
      }
      return minCol;
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(nearest(srcColor));
    }
  '''

combinations = (ary, len) -&gt;
  return [[]] unless len
  res = []
  for a, i in ary
    for last in combinations ary.slice(i + 1), len - 1
      res.push [a].concat(last)
  res

class Color
  constructor: (@r=0, @g=0, @b=0) -&gt;
  dist: (color) -&gt;
    [dr, dg, db] = [color.r - @r, color.g - @g, color.b - @b]
    Math.sqrt(dr * dr + dg * dg + db * db)
  luma: -&gt; @r * 0.3 + @g * 0.59 + @b * 0.11
  toArray: -&gt; [@r, @g, @b]
  toString: -&gt; &quot;rgb(#{@r}, #{@g}, #{@b})&quot;

# create imagedata from array of (array of colors)
makeCanvas = (width, height, ary) -&gt;
  ctx = document.createElement('canvas').getContext '2d'
  ctx.canvas.width  = width
  ctx.canvas.height = height
  idata = ctx.createImageData(width, height)
  for inner, x in ary
    if 'length' not of inner
      inner = [inner]
    for color, y in inner
      idata.data.set([
        color.r, color.g, color.b, 255
      ], (x + y * width) &lt;&lt; 2)
  ctx.putImageData(idata, 0, 0)
  ctx.canvas

colors = [
  new Color( 30,  30,  30)
  new Color(250, 250, 250)
  new Color(200,   0,   0)
  new Color(250, 200,   0)
  new Color(  0, 100,  50)
  new Color(  0,  50, 200)
  new Color( 30, 200,  30)
  new Color(250, 150, 250)
]

defaultCanvas = makeCanvas(16, 1, colors)
canvas =
  tone: makeCanvas 64, 2, combinations(
    colors.sort((a, b) -&gt; a.luma() - b.luma()), 2
  ).sort(
    ([a1, a2], [b1, b2]) -&gt; a1.dist(a2) - b1.dist(b2)
  ).slice(0, 64)

main = -&gt;
  gl = new MicroGL(antialias: false)
  tex = gl.texture document.getElementById('source')
  gl.init(null, 256, 256)
    .texParameter(tex, filter: 'NEAREST')
  for canv in document.querySelectorAll 'canvas'
    name = canv.id
    gl.program(vshader, fshader[name])
      .bindVars(
        a_position: [-1, -1, -1, 1, 1, -1, 1, 1] 
        u_source: tex
        u_colors: canvas[name] or defaultCanvas
      )
      .draw()
    canv.getContext('2d').drawImage(gl.gl.canvas, 0, 0)

window.addEventListener 'load', main, false</textarea></div><div class="editorBox" style="display:none"><textarea></textarea></div><!-- / .code --></div>
<!-- / #boxEditJS --></section>

<section id="boxEditHTML">
<ul class="tabCode group">
</ul>
<div class="code" id="boxCodeHTML">
<div class="editorBox"><div class="transparent"><img src="/img/spacer.gif" /></div><textarea id="codeHTML">&lt;img src=&quot;http://jsrun.it/assets/c/g/P/X/cgPXX.jpg&quot; id=&quot;source&quot;&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;nodither&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;tone&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;nterm&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;tknoll&quot;&gt;&lt;/canvas&gt;</textarea></div>
<!-- / .code --></div>
<!-- / #boxEditHTML --></section>

<section id="boxEditCSS">
<ul class="tabCode group">
    <li title="dithering algorithms" class="selected tabCSS initialTab"><span id="primaryTabTitle">dithering algorithms</span></li></ul>
<div class="code" id="boxCodeCSS">
<div class="editorBox"><div class="transparent"><img src="/img/spacer.gif" /></div><textarea id="codeCSS" data-lang="css"></textarea></div><!-- / .code --></div>
<!-- / #boxEditCSS --></section>

<script type="text/javascript">
  var theme               = "default";
  var uid                 = "aHp2";
//  var basefiles           = "/js/ace/ace.min.js?1441025678".match(/.+\/(.+?)$/).pop();
//  var editorjs            = "/js/ace/ace.min.js?1441025678".match(/.+\/(.+?)$/).pop();
  var basefiles           = "/js/codemirror/basefiles.js".substr(15); // "basefiles.js?1278486952"
  var editorjs            = "/js/codemirror/editor.js".substr(15);
  var has_long_line       = {};
  has_long_line["js"]     = 0;
  has_long_line["css"]    = 0;
  has_long_line["html"]   = 0;

  // 1st is initial
  var initial_tabs = { js: [""], css: [""] };  initial_tabs["js"].push( "/xl1/eHqL" );
  var code_site_uri = "http://jsrun.it/xl1/aHp2";
  var is_danger     = 0; // 1 or 0
  var lines         = [ 258,5,0 ];
</script><noscript>
<code>ref: [Arbitrary-palette positional dithering algorithm](http://bisqwit.iki.fi/story/howto/dither/jy/)</code>
<code>vshader = '''
  attribute vec2 a_position;
  varying vec2 v_texCoord;

  void main(){
    v_texCoord = a_position / 2.0 + vec2(0.5);
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
'''

fshaderBase = '''
  precision mediump float;
  uniform sampler2D u_source;
  uniform sampler2D u_colors;
  varying vec2 v_texCoord;

  const float GAMMA = 2.2;

  vec4 gamma(vec4 color){
    return pow(color, vec4(GAMMA));
  }
  vec4 ungamma(vec4 color){
    return pow(color, vec4(1.0 / GAMMA));
  }
  int ditherIdx(){
    float p = floor(mod(gl_FragCoord.x, 4.0));
    float q = floor(mod(p - gl_FragCoord.y, 4.0));
    return int(
      8.0 * mod(q, 2.0) +
      4.0 * mod(p, 2.0) +
      2.0 * floor(q / 2.0) +
      floor(p / 2.0)
    );
  }
'''

fshader =
  tone: fshaderBase + '''
    const int COMBINATIONS = 64;
    
    void getColors(in int idx, out vec4 c1, out vec4 c2){
      float x = (0.5 + float(idx)) / float(COMBINATIONS);
      c1 = gamma(texture2D(u_colors, vec2(x, 0.0)));
      c2 = gamma(texture2D(u_colors, vec2(x, 2.0)));
    }
    float ditherIndex(){
      return (0.5 + float(ditherIdx())) / 16.0;
    }
    float calculateBestRatio(vec4 srcColor, vec4 c1, vec4 c2){
      vec4 dif = c2 - c1;
      return floor(
        0.5 + dot(dif, srcColor - c1) / dot(dif, dif) * 16.0
      ) / 16.0;
    }
    vec4 dither(vec4 srcColor){
      vec4 c1, c2, canditate;
      float ratio;
      float d, minDist = 9.9;
      float index = ditherIndex();
      
      for(int i = 0; i &lt; COMBINATIONS; i++){
        getColors(i, c1, c2);
        ratio = calculateBestRatio(srcColor, c1, c2);
        d = distance(srcColor, mix(c1, c2, clamp(ratio, 0.0, 1.0)));
        if(minDist &gt; d){
          minDist = d;
          if(index &gt; ratio){
            canditate = c1;
          } else {
            canditate = c2;
          }
        }
      }
      return canditate;
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  nterm: fshaderBase + '''
    const int LOOPMAX = 16;
    const int COLORLEN = 16;

    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 dither(vec4 srcColor){
      vec4 sum = vec4(0.0);
      int total = 0, di = ditherIdx();
      
      float d, mind;
      vec4 color, next;
      int nextp;

      for(int i = 0; i &lt; LOOPMAX; i++){
        mind = 9.9;
        for(int j = 0; j &lt; COLORLEN; j++){
          color = getColor(j);
          for(int p = 1; p &lt; LOOPMAX; p++){
            d = distance(srcColor,
              mix(sum, color, float(p) / float(total + p))
            );
            if(mind &gt; d){
              mind = d;
              next = color;
              nextp = p;
            }
          }
        }
        sum = mix(sum, next, float(nextp) / float(total + nextp));
        total += nextp;
        if(total &gt; di) return next;
      }
      return vec4(0.0);
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  tknoll: fshaderBase + '''
    const int COLORLEN = 16;
    const float COEF = 0.2;
    
    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 nearest(vec4 srcColor){
      vec4 col, minCol;
      float d, mind = 9.9;
      
      for(int i = 0; i &lt; COLORLEN; i++){
        col = getColor(i);
        d = distance(srcColor, col);
        if(mind &gt; d){
          minCol = col;
          mind = d;
        }
      }
      return minCol;
    }
    vec4 dither(vec4 srcColor){
      int index = ditherIdx();
      vec4 nearCol, color = srcColor, err = vec4(0.0);
      for(int i = 0; i &lt; 16; i++){
        nearCol = nearest(srcColor + COEF * err);
        if(i == index) return nearCol;
        err += srcColor - nearCol;
      }
      return vec4(0.0);
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(dither(srcColor));
    }
  '''

  nodither: fshaderBase + '''
    const int COLORLEN = 16;
    
    vec4 getColor(int idx){
      float x = (0.5 + float(idx)) / float(COLORLEN);
      return gamma(texture2D(u_colors, vec2(x, 0.5)));
    }
    vec4 nearest(vec4 srcColor){
      vec4 col, minCol;
      float d, mind = 9.9;
      
      for(int i = 0; i &lt; COLORLEN; i++){
        col = getColor(i);
        d = distance(srcColor, col);
        if(mind &gt; d){
          minCol = col;
          mind = d;
        }
      }
      return minCol;
    }
    void main(){
      vec4 srcColor = gamma(texture2D(u_source, v_texCoord));
      gl_FragColor = ungamma(nearest(srcColor));
    }
  '''

combinations = (ary, len) -&gt;
  return [[]] unless len
  res = []
  for a, i in ary
    for last in combinations ary.slice(i + 1), len - 1
      res.push [a].concat(last)
  res

class Color
  constructor: (@r=0, @g=0, @b=0) -&gt;
  dist: (color) -&gt;
    [dr, dg, db] = [color.r - @r, color.g - @g, color.b - @b]
    Math.sqrt(dr * dr + dg * dg + db * db)
  luma: -&gt; @r * 0.3 + @g * 0.59 + @b * 0.11
  toArray: -&gt; [@r, @g, @b]
  toString: -&gt; &quot;rgb(#{@r}, #{@g}, #{@b})&quot;

# create imagedata from array of (array of colors)
makeCanvas = (width, height, ary) -&gt;
  ctx = document.createElement('canvas').getContext '2d'
  ctx.canvas.width  = width
  ctx.canvas.height = height
  idata = ctx.createImageData(width, height)
  for inner, x in ary
    if 'length' not of inner
      inner = [inner]
    for color, y in inner
      idata.data.set([
        color.r, color.g, color.b, 255
      ], (x + y * width) &lt;&lt; 2)
  ctx.putImageData(idata, 0, 0)
  ctx.canvas

colors = [
  new Color( 30,  30,  30)
  new Color(250, 250, 250)
  new Color(200,   0,   0)
  new Color(250, 200,   0)
  new Color(  0, 100,  50)
  new Color(  0,  50, 200)
  new Color( 30, 200,  30)
  new Color(250, 150, 250)
]

defaultCanvas = makeCanvas(16, 1, colors)
canvas =
  tone: makeCanvas 64, 2, combinations(
    colors.sort((a, b) -&gt; a.luma() - b.luma()), 2
  ).sort(
    ([a1, a2], [b1, b2]) -&gt; a1.dist(a2) - b1.dist(b2)
  ).slice(0, 64)

main = -&gt;
  gl = new MicroGL(antialias: false)
  tex = gl.texture document.getElementById('source')
  gl.init(null, 256, 256)
    .texParameter(tex, filter: 'NEAREST')
  for canv in document.querySelectorAll 'canvas'
    name = canv.id
    gl.program(vshader, fshader[name])
      .bindVars(
        a_position: [-1, -1, -1, 1, 1, -1, 1, 1] 
        u_source: tex
        u_colors: canvas[name] or defaultCanvas
      )
      .draw()
    canv.getContext('2d').drawImage(gl.gl.canvas, 0, 0)

window.addEventListener 'load', main, false</code>
<code>&lt;img src=&quot;http://jsrun.it/assets/c/g/P/X/cgPXX.jpg&quot; id=&quot;source&quot;&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;nodither&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;tone&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;nterm&quot;&gt;&lt;/canvas&gt;
&lt;canvas width=&quot;256&quot; height=&quot;256&quot; id=&quot;tknoll&quot;&gt;&lt;/canvas&gt;</code>
<code></code>
</noscript>

<!-- p class="btnFullScreen"><a href="http://jsdo.it/xl1/aHp2/read">Code Fullscreen</a></p -->
<!-- / .boxCode --></div>
<div class="boxViewer">
<iframe src="" width="465" height="465" id="generated_site">
use an iframe compat browser, deer
</iframe>
<div id="boxThumbViewer">
<p id="thumbnail"><img src="//jsdo-static-contents.s3.amazonaws.com/images/capture/a/H/p/aHp2.jpg?t=1364141461" width="465" height="465" /></p>
<p class="btnPlayViewer"><a href="javascript:void(0);" id="play_button" onclick="JSDoIt.CodeShow.play(); return false;"><img src="/img/common/play_button.png" alt="play" class="btn" /></a></p>
<!-- / #bixThumbViewer --></div>
<!-- /.boxViewer --></div>
</div>

<div id="codeUtilties" class="group">
	<ul class="utils group">
		<li>
			<form id="form_fork_sub" method="post" action="http://jsdo.it/xl1/aHp2/fork">
				<input type="submit" value="Fork" class="btnBase btnType5 btnSmall" id="fork_button_sub" name="btnFork" />
                                <input type="hidden" name="token" value="" />          
			</form>
		</li>		<li id="play_on_games_button" style="display: none;"><a href="http://games.jsdo.it/xl1/aHp2" class="btnBase btnType1 btnSmall"><span>Play on jsdo.it games</span></a><p class="arrow"><img src="/img/code/game/arrow.png" alt="" /></p></li>
		<li>
			<ul class="btnGroup group">
				<li class="tab" data-tab-name="author"><span class="btnBase btnType6 btnSmall">Author</span></li>
				<li class="tab active" data-tab-name="socialFeedback"><span class="btnBase btnType6 btnSmall active">Share</span></li>
				<li class="tab" data-tab-name="embed"><span class="btnBase btnType6 btnSmall">ブログに埋め込む</span></li>
				<li class="tab" data-tab-name="qrcode"><span class="btnBase btnType6 btnSmall">QR</span></li>
				<li class="tab" data-tab-name="tag"><span class="btnBase btnType6 btnSmall">Tag</span></li>
			</ul>
		</li>
		<li class="download"><a href="http://jsdo.it/xl1/aHp2/download" class="btnBase btnType6 btnSmall btnInvisible" title="download"><img src="/img/common/ico/ico_download_01.png" width="17" height="13" alt="download" title="download">Download</a></li>
	</ul>
	<div class="utilDetails clearfix">
		<section class="blockCodeUtil games">
		<div class="col2">
		<div>
		<a href="http://games.jsdo.it" target="_blank"><img src="/img/code/jsdoitGames.png" id="jsdoitGamesImage" width="114" height="116"></a>

		</div>
		<div>
		<p class="msgComplete">Complete!</p>
		<div class="blockInputFormStyle1">
		<form id="form_sub_games" action="/api/code/post_to_games" data-saved="0">
		<input type="hidden" name="token" value="" />
		<input type="hidden" name="uid" value="aHp2" />
		<div class="inputItem description">
		<h2>Description <span>What kind of game?</span></h2>
		<p class="msgError txtError"></p>
		<div class="comment">
		<textarea required="required" name="description">ref: [Arbitrary-palette positional dithering algorithm](http://bisqwit.iki.fi/story/howto/dither/jy/)</textarea>
		</div>
		</div>
		<div class="inputItem device">
		<h2>Control Device <span></span></h2>
		<p class="msgError txtError"></p>
		<div class="comment">
		<table>
		<tr>
		<th scope="row">
		<p class="image"><img src="/img/code/game/ico_jwc.png" alt="jsdo.it websocket controller" /></p>
		</th>
		<td>
		<label><input type="checkbox" class="flag" data-device="1" name="support_spctrl" value="1"  />Smartphone Controller<a href="/controller">jsdo.it WebSocket Controller</a>»</label>
		<div class="detail device1">
		<ul>
		<li>
		<p class="icon"><img src="/img/code/game/btn_arrow.png" alt=""></p>
		<input type="text" name="stick" value="" />
		</li>
		<li>
		<p class="icon"><img src="/img/code/game/btn_start.png"></p>
		<input type="text" name="button_start" /value="" >
		</li>
		<li>
		<p class="icon"><img src="/img/code/game/btn_a.png"></p>
		<input type="text" name="button_a" value="" />
		</li>
		<li>
		<p class="icon"><img src="/img/code/game/btn_b.png"></p>
		<input type="text" name="button_b" value="" />
		</li>
		</ul>
		</div>
		</td>
		</tr>
		<tr>
		<th scope="row">
		<p class="image"><img src="/img/code/game/ico_mouse.png" alt="Mouse" /></p>
		</th>
		<td>
		<label><input type="checkbox" class="flag" data-device="3" name="support_mouse" value="1"  />Mouse</label>
		<div class="detail device3">
		<textarea name="mouse" placeholder="How to play"></textarea>
		</div>
		</td>
		</tr>
		<tr>
		<th scope="row">
		<p class="image"><img src="/img/code/game/ico_keyboard.png" alt="keyboard" /></p>
		</th>
		<td>
		<label><input type="checkbox" class="flag" data-device="4" name="support_keyboard" value="1"  />Keyboard</label>
		<div class="detail device4">
		<textarea name="keyboard" placeholder="How to play"></textarea>
		</div>
		</td>
		</tr>
		<tr>
		<th scope="row">
		<p class="image"><img src="/img/code/game/ico_smartphone.png" alt="smartphone" /></p>
		</th><td>
		<label><input type="checkbox" class="flag" data-device="2"  name="support_touchdevice" value="1"  />Touch Device</label>
		<div class="detail device2">
		<textarea name="touchdevice" placeholder="How to play"></textarea>
		</div>
		</td>
		</tr>
		</table>
		</div>
		</div>
		<div class="inputItem screen valid">
		<h2>Fullscreen<span></span></h2>
		<p class="msgError txtError"></p>
		<div class="comment">
		<ul>
		<li><label><input type="radio" name="support_fullscreen" value="1" checked> Activated</label></li>
		<li><label><input type="radio" name="support_fullscreen" value="0" > Inactivated</label></li>
		</ul>
		</div>
		</div>
		<div class="submit">
		<a id="game_delete_button" href="javascript:void(0)" class="btnBase btnType6 btnSmall btnInvisible" >jsdo.it games から削除する</a>
		<a id="game_submit_button" class="btnBase btnType5" disabled="disabled" href="javascript:void(0)">Submit</a>
		</div>
		</form><!-- form_sub_games  -->
		<!-- / .blockInputFormStyle1 --></div>
		</div>
		</div>
		<!-- / .embed --></section>
		<section class="blockCodeUtil author" itemscope itemtype="http://data-vocabulary.org/Person">
			<div class="col2 group">
				<div class="image">
					<p class="thumb"><a href="http://jsdo.it/xl1" title="xl1"><img src="//jsdo-static-contents.s3.amazonaws.com/images/icon/8/6/d/6/86d60104ce558994d02cd5e2e1cc4fdcbaccf61e_100.jpg" width="100" height="100" alt="xl1" title="xl1" itemprop="photo" /></a></p>
				<!-- / .image --></div>
				<div class="information">
					<h1 class="hidden">Author</h1>
					<div class="user">
						<p class="name"><a href="http://jsdo.it/xl1" title="xl1" rel="author"><span itemprop="name">xl1</span></a></p>
					</div>
					<ul class="metas group">
                        
                        
                        
                        
					</ul>
					<div class="discription markdown">
						

					</div>
				<!-- / .information --></div>
			</div>
		<!-- / .author --></section>
		<section class="blockCodeUtil socialFeedback active">
			<ul class="group">
			<li class="facebook"><fb:like href="http://jsdo.it/xl1/aHp2" send="false" layout="button_count" width="55" show_faces="false" font="verdana"></fb:like></li>
			
			<li class="stumbleupon"><script src="http://www.stumbleupon.com/hostedbadge.php?s=4"></script></li>
			
			  <a href="http://twitter.com/share" class="twitter-share-button" data-text="dithering algorithms #jsdoit" data-count="horizontal" data-related="jsdoit_team">Tweet</a><script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>
			  
			<li class="plusone"><g:plusone size="medium" href="http://jsdo.it/xl1/aHp2"></g:plusone></li>
			</ul>
		<!-- / .socialFeedback --></section>
		<section class="blockCodeUtil embed">
			<div class="col2 widgetDesignBox group">
				<div class="image">
					<img src="/img/code/widget_design_view.png" width="660px" height="116px">
				</div>
				<div>
					<div class="blockInputFormStyle1">
						<div class="inputItem">
							<h2>Default Panel</h2>
							<div class="comment">
								<ul class="select selectDefaultPanel">
									<li><label><input type="radio" name="defaultTab" value="play">Auto play</label></li>
									<li><label><input type="radio" name="defaultTab" value="screenshot">Screenshot</label></li>
									<li><label><input type="radio" name="defaultTab" value="readme" checked="checked">Readme</label></li>
									<li><label><input type="radio" name="defaultTab" value="javascript">JavaScript</label></li>
									<li><label><input type="radio" name="defaultTab" value="html">HTML</label></li>
									<li><label><input type="radio" name="defaultTab" value="css">CSS</label></li>
								</ul>
							</div>
						</div>
						<div class="inputItem">
							<h2>Size</h2>
							<div class="comment">
								<ul class="selectEmbedSize">
									<li>Width: <input type="number" class="width inline" min="465" value="465" style="width:60px;"> px</li>
									<li>Height: <input type="number" class="height inline" min="496" value="496" style="width:60px;"> px</li>
								</ul>
							</div>
						</div>
						<div class="inputItem">
							<h2>code</h2>
							<div class="comment">
								<textarea readonly="readonly" onclick="javascript:this.select();" data-url="http://jsdo.it/blogparts/aHp2/js">&lt;script type=&quot;text/javascript&quot; src=&quot;http://jsdo.it/blogparts/aHp2/js&quot;&gt;&lt;/script&gt;</textarea>
							</div>
						</div>
					<!-- / .blockInputFormStyle1 --></div>
				</div>
			</div>
		<!-- / .embed --></section>
		<section class="blockCodeUtil qrcode">
			<div class="col2 group">
				<div>
					<p class="code"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chl=http://jsdo.it" width="150" height="150" alt="QR Code"></p>
				</div>
				<div> 
				</div>
			</div>
		<!-- / .qrcode --></section>
		<section class="blockCodeUtil tag">
			<ul class="listTags">
			<li><a href="http://jsdo.it/tag/webgl" rel="tag">webgl</a></li>
			</ul>
		<!-- / .tag --></section>	
	<!-- / .utilDetails --></div>
<!-- / #codeUtilties --></div>

<!-- / .viewer --></section>

<!-- /.code --></section>

<section class="discussion">
	<header><h1 class="ttlStyle2">Discussion</h1></header>
	<div>
		<ul>
		</ul>
		<p class="post"><a href="/qa/create?code_uri=http://jsdo.it/xl1/aHp2" class="btnBase btnType1">Questions on this code?</a></p>
	</div>
<!-- / .discussion --></section>

<div class="ad_super_bnr btnT"><!-- jsdo.it_codepage_fullbnr_en --> <script type='text/javascript'> GA_googleFillSlot("jsdo.it_codepage_fullbnr_en"); </script>
<!-- /.ad_super_bnr --></div>

<section>
<header><h1 class="ttlStyle2">Tags</h1></header>

<ul class="listTags group">
    
    <li><a href="http://jsdo.it/tag/image%2Bprocessing" title="image+processing" class="">image+processing</a></li>
    
    <li><a href="http://jsdo.it/tag/webgl" title="webgl" class="">webgl</a></li>
</ul>

<!-- /.tags --></section>








<section class="favorite">
<header><h1 class="ttlStyle2">Favorite by</h1></header>
    <div class="unitGroup group">
          <div class="unitFavBy"><span class="thumb"><a href="http://jsdo.it/tjoen" title="tjoen"><img src="//jsdo-static-contents.s3.amazonaws.com/images/icon/5/b/7/5/5b756e495a8c352439705bb865c0fa9d86389713_100.jpg" width="30" height="30" alt="tjoen" title="tjoen" /></a></span><a href="http://jsdo.it/tjoen" title="tjoen">tjoen</a>
          <!-- /.unitFavBy --></div>
	<!-- /.unitGroup --></div>

<div class="unitFavUserL group">
  <p class="user"><span class="thumb"><a href="http://jsdo.it/alvarobyrne" title="alvarobyrne"><img src="/img/common/img_user_anonymous.gif" width="30" height="30" alt="alvarobyrne" title="alvarobyrne" /></a></span><a href="http://jsdo.it/alvarobyrne" title="alvarobyrne">alvarobyrne</a>: </p>
  <p class="comment"><a href="http://jsdo.it/tag/image%2Bprocessing" title="image+processing" class="tag">image+processing</a></p><!-- /#unitFavUserL --></div>


<!-- /.favorite --></section>












<!-- /#codeDetail --></article>

<div id="diff_container"></div>
<div id="diff_controller">
  <a href="#" id="diff_close_button"><img src="/img/code/close.gif" class="btnT"></a>
</div>

<div id="fb-root"></div><script src="http://connect.facebook.net/en_US/all.js#appId=107163819375320&amp;xfbml=1"></script>

<!-- /#body --></div>
<!--/[[[ CONTENT-AREA ]]]-->
<footer id="siteFooter" class="layoutWideContainer">
<div class="layoutContainer layoutLiquid group">
<div class="apps group">
<div class="col1">
<a href="/users"><p class="userRanking">User ranking</p></a>
<a href="/codes/ranking"><p class="codeRanking">Code ranking</p></a>
</div>
<div class="col2">
<a href="/event/topics">
<section class="event">
<h1>Topics &amp; Events</h1>
<p>"I want to make something but don't know what to make." "We want to know the newest trends!" Responding to those voices, we are regularly hosting events and updating topics.</p>
</section>
</a>
</div>
<div class="col3">
<a href="/qa">
<section class="discussions">
<h1>Discussions</h1>
<p>Any questions? Ask jsdo.it users! You can post questions together with your code. You can also get answers supported by a code.</p>
</section>
</a>
</div>
<!-- / .apps --></div>
<section class="account">
<h1>Completely Free Account</h1>
<p>
<form method="post" action="/code/new">
<input type="hidden" name="token" value="">
<p class="btnLabel labelFree"><input type="submit" class="btnBase btnType5" value="Sign up Free and Start coding"></p>
</form>
</p>
</section>
<div class="globals group">
<nav>
<ul>

<li><a href="http://twitter.com/#!/jsdoit_team" class="external" rel="external">@jsdoit_team</a></li>
<li><a href="http://www.facebook.com/jsdo.it" target="_blank" class="external" rel="external">Facebook</a></li>


</ul>
<ul>
<li><a href="/about" title="What's jsdo.it?">About</a></li>
<li><a href="/assets">Assets</a></li>
<li><a href="/help">Help</a></li>
<li><a href="/blog">Blog</a></li>
<li><a href="/apidoc/">API</a></li>
<li><a href="/terms">Term of use</a></li>
<li><a href="/privacy_policy/">Privacy policy</a></li>
<li><a href="/help#help_contact">Contact</a></li>
</ul>
</nav> 
<p id="copyright" class="vcard"><small>Site Design &copy; <a href="http://www.jsdo.it/" title="jsdoit Inc." class="external fn org url">jsdoit Inc.</a> All Rights Reserved.</small></p>
<!-- / .globals --></div>
</div>
<!-- / #siteFooter --></footer>


<!--/#container--></div>



<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-15793157-5']);
  _gaq.push(['_setDomainName', '.jsdo.it']);
  _gaq.push(['_setAllowLinker', true]);
  _gaq.push(['_setAllowHash', false]);
  _gaq.push(['_trackPageLoadTime']);
  _gaq.push(['_trackPageview', '/code/show'+location.pathname]);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


<script type="text/javascript">
var path  = "code/show";
var token = "";
</script>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>

<script type="text/javascript" src="/js/do.js?1441025678"></script>
 <script type="text/javascript" src="/js/notification.js?1441025678"></script>
<script type="text/javascript" src="http://apis.google.com/js/plusone.js"></script>


<script type="text/javascript" src="/js/codemirror/codemirror-compressed.js?1441025678"></script>
</body>
</html>
